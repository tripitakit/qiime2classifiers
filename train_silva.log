 # Train Silva 138.1 Naive Bayes classifier for 341F-805R region

$ conda activate qiime2-amplicon-2024.5

$ qiime feature-classifier extract-reads \
  --i-sequences silva138.1_ref-seqs.qza \
  --p-f-primer CCTACGGGNGGCWGCAG \
  --p-r-primer GACTACHVGGGTATCTAATCC \
  --p-min-length 300 \
  --p-max-length 500 \
  --o-reads 341F-805R-ref-seqs.qza \
  --p-n-jobs 12 \
  --verbose

		Saved FeatureData[Sequence] to: 341F-805R-ref-seqs.qza

$ qiime feature-classifier fit-classifier-naive-bayes \
  --i-reference-reads 341F-805R-ref-seqs.qza \
  --i-reference-taxonomy silva138.1_ref-tax.qza \
  --o-classifier 341F-805R-silva138.1-classifier.qza \
  --p-verbose

7:38 -> 9:42

		Saved TaxonomicClassifier to: 341F-805R-silva138.1-classifier.qza

# Test the classifier
$ qiime feature-classifier classify-sklearn \
  --i-classifier 341F-805R-silva138.1-classifier.qza \
  --i-reads test-rep-seqs.qza \
  --o-classification taxonomy.qza

$ qiime metadata tabulate \
  --m-input-file taxonomy.qza \
  --o-visualization taxonomy.qzv

$ qiime tools view taxonomy.qzv